;; ===========================================================================
;; Forgejo Application Configuration (`/usr/local/etc/forgejo/app.ini`)
;; ===========================================================================

;; --- Overall Application Settings ---
APP_NAME = git.jsmx.org              ; Name displayed in the UI
RUN_USER = git                  ; User Forgejo runs as (created by pkg)
RUN_MODE = prod                 ; Use 'prod' for production (disables debug info)

;; --- Server Settings ---
[server]
;; External URLs (what users see, handled by OpenResty/Cloudflare)
DOMAIN           = git.jsmx.org          ; Your main domain (used in URLs)
ROOT_URL         = https://git.jsmx.org/ ; Base URL (use HTTPS)

;; Internal Listening (Forgejo inside the jail)
HTTP_ADDR        = 0.0.0.0             ; Listen on all jail network interfaces
HTTP_PORT        = 80                  ; Listen on port 80 inside the jail (proxy targets this)

;; SSH Settings (Requires separate non-proxied DNS for Cloudflare)
DISABLE_SSH      = false               ; Enable SSH access
SSH_DOMAIN       = ssh.git.jsmx.org    ; !! Your NON-proxied DNS record for SSH !!
SSH_PORT         = 22                  ; Standard SSH port inside the jail
START_SSH_SERVER = true                ; Use Forgejo's built-in SSH server

;; Other Server Settings
OFFLINE_MODE     = false               ; Allow fetching external resources (avatars, etc.)
LANDING_PAGE     = explore             ; Optional: change default page (e.g., login, explore)

;; --- Database Settings ---
[database]
DB_TYPE  = sqlite3                    ; Using SQLite
PATH     = /var/db/forgejo/forgejo.db ; Location of the SQLite database file
SQLITE_JOURNAL_MODE  = WAL            ; much faster concurrency
# HOST, NAME, USER, PASSWD are ignored for sqlite3

;; --- Repository Settings ---
[repository]
ROOT = /var/db/forgejo/forgejo-repositories   ; Root directory for all Git repositories
SCRIPT_TYPE = bash

;; --- Logging Settings ---
[log]
MODE      = file                  ; Log to files
LEVEL     = Info                  ; Log level (Trace, Debug, Info, Warn, Error, Critical)
ROOT_PATH = /var/log/forgejo      ; Directory for log files

;; --- Security Settings ---
[security]
INSTALL_LOCK = true                ; !! Set to true AFTER initial web setup !! Prevents re-running install
SECRET_KEY   =                     ; Leave blank to auto-generate on first run, or paste a long random string (e.g., `openssl rand -hex 64`)
INTERNAL_TOKEN = CHANGE_ME
# REVERSE_PROXY_TRUSTED_PROXIES = 10.0.49.87/32 ; Optional: Explicitly trust your OpenResty host IP if needed. Usually automatic with correct headers.

;; --- Cache Settings ---
[cache]
ADAPTER = twoqueue             
HOST    = {"size":100, "recent_ratio":0.25, "ghost_ratio":0.5} 

;; --- Service Settings ---
[service]
# Optional: Disable self-registration if you want invite-only
DISABLE_REGISTRATION = true
# ENABLE_NOTIFY_MAIL   = true ; Requires configuring [mailer] section

[oauth2]
JWT_SECRET = CHANGE_ME

;; --- Mailer Settings (Optional) ---
;[mailer]
;ENABLED = true
;HOST    = smtp.example.com:587
;FROM    = forgejo@git.jsmx.org
;USER    = your_smtp_username
;PASSWD  = your_smtp_password
;SKIP_VERIFY = false

;; --- Other Sections (Defaults are usually okay to start) ---
;[ui]
;[session]
;[picture]
;[attachment]
